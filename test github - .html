<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Organigramme Participatif - Festoch' Viens Chercher Bonheur</title>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans+Condensed:wght@300;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-firestore-compat.js"></script>
  <style>
    body { font-family: 'Open Sans Condensed', sans-serif; background-color: #f0fdf4; margin: 0; padding: 0; }
    .container { max-width: 1200px; margin: 20px auto; padding: 20px; display: flex; flex-wrap: wrap; gap: 20px; }
    header { text-align: center; margin-bottom: 20px; }
    header h1 { color: #15803d; margin-bottom: 10px; font-size: 3.5em; font-family: 'Open Sans Condensed', sans-serif; }
    header img { max-width: 150px; height: auto; margin-top: 10px; }
    .pole-tile { background-color: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); width: calc(33% - 20px); box-sizing: border-box; transition: transform 0.2s, box-shadow 0.2s; }
    .pole-tile:hover { transform: translateY(-5px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
    @media (max-width: 768px) { .pole-tile { width: calc(100% - 20px); } }
    .pole-title { font-size: 1.8em; font-weight: bold; color: #16a34a; margin-bottom: 15px; }
    .pole-referents { font-weight: bold; color: #4b5563; }
    .button { background-color: #a7f3d0; color: #15803d; border: none; border-radius: 10px; padding: 12px 25px; cursor: pointer; font-size: 1.1em; transition: background-color 0.3s; }
    .button:hover { background-color: #34d399; color: white; }
    .infos-container, .inscription-container { display: none; background: #eff6ff; border: 1px solid #d1d8f3; border-radius: 10px; padding: 10px; margin-top: 10px; }
    input[type="text"] { padding: 10px; border: 1px solid #d1d5db; border-radius: 5px; margin-right: 10px; }
    input:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59,130,246,0.2); }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div><img src="https://i.ibb.co/SXXRkwXW/logo-VCB-2023-V2-3.png" alt="logo"></div>
      <h1>Organigramme Participatif pour le Festoch' Viens Chercher Bonheur</h1>
    </header>

    <div class="pole-tile" data-pole="prev">
      <h2 class="pole-title">Pôle Prév</h2>
      <p class="pole-referents">Référents : Matt C, Cricri, Nico, Marco</p>
      <button class="button inscrire-btn">M'inscrire</button>
      <div class="inscription-container">
        <label>Ton prénom :</label>
        <input type="text" class="prenom-input">
        <button class="button valider-btn">Valider</button>
        <ul class="liste-inscrits mt-2 list-disc list-inside"></ul>
      </div>
    </div>

    <div class="pole-tile" data-pole="bar">
      <h2 class="pole-title">Pôle Bar</h2>
      <p class="pole-referents">Référents : Ro et Mat</p>
      <button class="button inscrire-btn">M'inscrire</button>
      <div class="inscription-container">
        <label>Ton prénom :</label>
        <input type="text" class="prenom-input">
        <button class="button valider-btn">Valider</button>
        <ul class="liste-inscrits mt-2 list-disc list-inside"></ul>
      </div>
    </div>

    <div class="pole-tile" data-pole="cuisine">
      <h2 class="pole-title">Pôle Cuisine</h2>
      <p class="pole-referents">Référents : Nono</p>
      <button class="button inscrire-btn">M'inscrire</button>
      <div class="inscription-container">
        <label>Ton prénom :</label>
        <input type="text" class="prenom-input">
        <button class="button valider-btn">Valider</button>
        <ul class="liste-inscrits mt-2 list-disc list-inside"></ul>
      </div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCZP6OfDs1R0rXqlQRTDm2poCt2CAoCK9U",
      authDomain: "festoch-orgamme.firebaseapp.com",
      databaseURL: "https://festoch-orgamme-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "festoch-orgamme",
      storageBucket: "festoch-orgamme.firebasestorage.app",
      messagingSenderId: "1076396926378",
      appId: "1:1076396926378:web:f8815d878def0985b9b7d3"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    document.querySelectorAll('.pole-tile').forEach(poleTile => {
      const pole = poleTile.dataset.pole;
      const btnInscrire = poleTile.querySelector('.inscrire-btn');
      const form = poleTile.querySelector('.inscription-container');
      const input = poleTile.querySelector('.prenom-input');
      const btnValider = poleTile.querySelector('.valider-btn');
      const liste = poleTile.querySelector('.liste-inscrits');

      btnInscrire.addEventListener('click', () => {
        form.style.display = form.style.display === 'none' || form.style.display === '' ? 'block' : 'none';
      });

      btnValider.addEventListener('click', () => {
        const prenom = input.value.trim();
        if (!prenom) return alert("Entre ton prénom");
        db.collection("inscriptions").add({ pole, prenom, timestamp: new Date() });
        input.value = "";
      });

      db.collection("inscriptions").where("pole", "==", pole).orderBy("timestamp")
        .onSnapshot(snapshot => {
          liste.innerHTML = "";
          snapshot.forEach(doc => {
            const li = document.createElement("li");
            li.textContent = doc.data().prenom;
            liste.appendChild(li);
          });
        });
    });
  </script>
</body>
</html>
